<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="jiuchengBlog 博客">
    <meta name="description" content="hello, here is JiuCheng&#39; s blog">
    <meta name="author" content="馨er">
    
    <title>
        
            Vue3.0笔记 |
        
        馨er的学习之路
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.png">
    
<link rel="stylesheet" href="/css/font-awesome.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"jiucheng120.github.io","root":"/","language":"zh-CN","path":"search.xml"};
    KEEP.theme_config = {"toc":{"enable":true,"number":false,"expand_all":true,"init_open":false},"style":{"primary_color":"#CC00FF","avatar":"/images/avatar.png","favicon":"/images/logo.png","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":true,"scale":true},"first_screen":{"enable":true,"background_img":"/images/bg.png","description":"Keep writing and Keep loving."},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"mac"},"pjax":{"enable":true},"lazyload":{"enable":false},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"};
  </script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="/images/avatar.png">
                </a>
            
            <a class="logo-title" href="/">
                馨er的学习之路
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class href="/">
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class href="/archives">
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class href="/categories">
                                分类
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class href="/tags">
                                标签
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class href="/about">
                                关于
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/jiucheng120">
                                GITHUB
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class href="/categories">分类</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class href="/tags">标签</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class href="/about">关于</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/jiucheng120">GITHUB</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">Vue3.0笔记</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.png">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">馨er</span>
                        
                            <span class="author-label">CTO</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2022-04-14 18:19:36</span>
        <span class="mobile">2022-04-14 18:19</span>
    </span>
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/%E5%89%8D%E7%AB%AF/">前端</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/Vue/">Vue</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>9.2k 字</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>46 分钟</span>
        </span>
    
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <blockquote>
<p>Vue3.0笔记</p>
</blockquote>
<span id="more"></span>



<h1 id="1-02diff算法——理解-amp-amp-03静态提升和监听缓存"><a href="#1-02diff算法——理解-amp-amp-03静态提升和监听缓存" class="headerlink" title="1 02diff算法——理解&amp;&amp;03静态提升和监听缓存"></a>1 02diff算法——理解&amp;&amp;03静态提升和监听缓存</h1><h2 id="1-1-Vue3-0中的六大亮点"><a href="#1-1-Vue3-0中的六大亮点" class="headerlink" title="1.1 Vue3.0中的六大亮点"></a>1.1 Vue3.0中的六大亮点</h2><table>
<thead>
<tr>
<th>序号</th>
<th>特性</th>
<th>解析</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td><code>Performance </code></td>
<td>性能上比Vue2.0快1.3~2倍</td>
</tr>
<tr>
<td>2</td>
<td><code>Tree shaking support </code></td>
<td>按需编译，体积更加轻量化</td>
</tr>
<tr>
<td>3</td>
<td><code>Composition API</code></td>
<td>组合API，可参考<code>React hooks</code>理解</td>
</tr>
<tr>
<td>4</td>
<td><code>Better TypeScript support</code></td>
<td>对 Ts 提供了更好的支持</td>
</tr>
<tr>
<td>5</td>
<td><code>Custom Renderer API</code></td>
<td>暴露了自定义渲染API</td>
</tr>
<tr>
<td>6</td>
<td><code>Fragment,Teleport(Protal),Suspense</code></td>
<td>更先进的组件</td>
</tr>
</tbody></table>
<h2 id="1-2-Vue是如何变快的"><a href="#1-2-Vue是如何变快的" class="headerlink" title="1.2 Vue是如何变快的"></a>1.2 Vue是如何变快的</h2><h3 id="1-2-1-diff方法优化"><a href="#1-2-1-diff方法优化" class="headerlink" title="1.2.1 diff方法优化"></a>1.2.1 diff方法优化</h3><ul>
<li>Vue2中的虚拟dom是进行全量比对</li>
<li>Vue3新增了静态标记（PatchFlag）<br> 在与上次虚拟节点进行比对时候，只对比带有patch flag的节点<br> 并且可以通过flag的信息 得知当前节点要比对的具体内容</li>
</ul>
<h4 id="1、Vue2-diff算法"><a href="#1、Vue2-diff算法" class="headerlink" title="1、Vue2 diff算法"></a>1、Vue2 diff算法</h4><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/4156/20220414192452.webp"></p>
<h4 id="2、Vue3-diff算法"><a href="#2、Vue3-diff算法" class="headerlink" title="2、Vue3 diff算法"></a>2、Vue3 diff算法</h4><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/4156/20220414192534.webp"></p>
<h4 id="3、Vue编译demo"><a href="#3、Vue编译demo" class="headerlink" title="3、Vue编译demo"></a>3、Vue编译demo</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>我是段落<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  createVNode <span class="keyword">as</span> _createVNode,</span><br><span class="line">  toDisplayString <span class="keyword">as</span> _toDisplayString,</span><br><span class="line">  openBlock <span class="keyword">as</span> _openBlock,</span><br><span class="line">  createBlock <span class="keyword">as</span> _createBlock</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (_openBlock(), _createBlock(<span class="string">&quot;div&quot;</span>, <span class="literal">null</span>, [</span><br><span class="line">    _createVNode(<span class="string">&quot;p&quot;</span>, <span class="literal">null</span>, <span class="string">&quot;我是段落&quot;</span>),</span><br><span class="line">    _createVNode(<span class="string">&quot;p&quot;</span>, <span class="literal">null</span>, _toDisplayString(_ctx.msg), <span class="number">1</span> <span class="comment">/* TEXT */</span>)</span><br><span class="line">  ]))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4、附录PatchFlags"><a href="#4、附录PatchFlags" class="headerlink" title="4、附录PatchFlags"></a>4、附录PatchFlags</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> enum PatchFlags &#123;</span><br><span class="line">  TEXT = <span class="number">1</span>, <span class="comment">// 动态文本节点</span></span><br><span class="line">  CLASS = <span class="number">1</span> &lt;&lt; <span class="number">1</span>, <span class="comment">// 2 动态class</span></span><br><span class="line">  STYLE = <span class="number">1</span> &lt;&lt; <span class="number">2</span>, <span class="comment">// 4 动态style</span></span><br><span class="line">  PROPS = <span class="number">1</span> &lt;&lt; <span class="number">3</span>, <span class="comment">// 8 动态属性，但不包含类名和样式</span></span><br><span class="line">  FULL_PROPS = <span class="number">1</span> &lt;&lt; <span class="number">4</span>, <span class="comment">// 16 具有动态 key 属性，当 key 改变时，需要进行完整的 diff 比较</span></span><br><span class="line">  HYDRATE_EVENTS = <span class="number">1</span> &lt;&lt; <span class="number">5</span>, <span class="comment">// 32 带有监听事件的节点</span></span><br><span class="line">  STABLE_FRAGMENT = <span class="number">1</span> &lt;&lt; <span class="number">6</span>, <span class="comment">// 64 一个不会改变子节点顺序的 fragment</span></span><br><span class="line">  KEYED_FRAGMENT = <span class="number">1</span> &lt;&lt; <span class="number">7</span>, <span class="comment">// 128 带有key属性的 fragment 或部分带有 key</span></span><br><span class="line">  UNKEYED_FRAGMENT = <span class="number">1</span> &lt;&lt; <span class="number">8</span>, <span class="comment">// 256 子节点没有 key 的 fragment</span></span><br><span class="line">  NEED_PATCH = <span class="number">1</span> &lt;&lt; <span class="number">9</span>, <span class="comment">// 512 一个节点只会进行非 props 比较</span></span><br><span class="line">  DYNAMIC_SLOTS = <span class="number">1</span> &lt;&lt; <span class="number">10</span>, <span class="comment">// 1024</span></span><br><span class="line">  HOISTED = -<span class="number">1</span>,</span><br><span class="line">  BAIL = -<span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-2-2-hoistStatic-静态提升"><a href="#1-2-2-hoistStatic-静态提升" class="headerlink" title="1.2.2 hoistStatic 静态提升"></a>1.2.2 hoistStatic 静态提升</h3><ul>
<li>Vue2中无论元素是否参与更新，每次都会重新创建，然后再渲染</li>
<li>Vue3中对于不参与更新的元素，会做静态提升，只会被创建一次，在渲染时直接复用即可</li>
</ul>
<h4 id="1、Vue编译demo"><a href="#1、Vue编译demo" class="headerlink" title="1、Vue编译demo"></a>1、Vue编译demo</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>我是段落<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  createVNode <span class="keyword">as</span> _createVNode,</span><br><span class="line">  toDisplayString <span class="keyword">as</span> _toDisplayString,</span><br><span class="line">  openBlock <span class="keyword">as</span> _openBlock,</span><br><span class="line">  createBlock <span class="keyword">as</span> _createBlock</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> _hoisted_1 = <span class="comment">/*#__PURE__*/</span>_createVNode(<span class="string">&quot;p&quot;</span>, <span class="literal">null</span>, <span class="string">&quot;我是段落&quot;</span>, -<span class="number">1</span> <span class="comment">/* HOISTED */</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (_openBlock(), _createBlock(<span class="string">&quot;div&quot;</span>, <span class="literal">null</span>, [</span><br><span class="line">    _hoisted_1,</span><br><span class="line">    _createVNode(<span class="string">&quot;p&quot;</span>, <span class="literal">null</span>, _toDisplayString(_ctx.msg), <span class="number">1</span> <span class="comment">/* TEXT */</span>)</span><br><span class="line">  ]))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-2-3-cacheHandlers事件侦听器缓存"><a href="#1-2-3-cacheHandlers事件侦听器缓存" class="headerlink" title="1.2.3 cacheHandlers事件侦听器缓存"></a>1.2.3 cacheHandlers事件侦听器缓存</h3><ul>
<li>默认情况下onClick会被视为动态绑定，所以每次都会去追踪它的变化，但是因为是同一个函数，所以没有追踪变化，直接缓存起来复用即可</li>
</ul>
<h4 id="1、Vue编译demo-1"><a href="#1、Vue编译demo-1" class="headerlink" title="1、Vue编译demo"></a>1、Vue编译demo</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;onClick&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>关闭事件侦听器缓存</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  createVNode <span class="keyword">as</span> _createVNode,</span><br><span class="line">  openBlock <span class="keyword">as</span> _openBlock,</span><br><span class="line">  createBlock <span class="keyword">as</span> _createBlock</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (_openBlock(), _createBlock(<span class="string">&quot;div&quot;</span>, <span class="literal">null</span>, [</span><br><span class="line">    _createVNode(<span class="string">&quot;button&quot;</span>, &#123; <span class="attr">onClick</span>: _ctx.onClick &#125;, <span class="string">&quot;按钮&quot;</span>, <span class="number">8</span> <span class="comment">/* PROPS */</span>, [<span class="string">&quot;onClick&quot;</span>])</span><br><span class="line">  ]))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>开启事件侦听器缓存</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  createVNode <span class="keyword">as</span> _createVNode,</span><br><span class="line">  openBlock <span class="keyword">as</span> _openBlock,</span><br><span class="line">  createBlock <span class="keyword">as</span> _createBlock</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (_openBlock(), _createBlock(<span class="string">&quot;div&quot;</span>, <span class="literal">null</span>, [</span><br><span class="line">    _createVNode(<span class="string">&quot;button&quot;</span>, &#123;</span><br><span class="line">      onClick: _cache[<span class="number">1</span>] || (_cache[<span class="number">1</span>] = <span class="function">(<span class="params">...args</span>) =&gt;</span> (_ctx.onClick(...args)))</span><br><span class="line">    &#125;, <span class="string">&quot;按钮&quot;</span>)</span><br><span class="line">  ]))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意点：转换之后的代码，大家可能还看不懂，但是不要紧，我们只需要观察有没有静态标记即可，因为我们知道在Vue3的diff算法中，只有有静态标记的才会进行比较，才会进行追踪</p>
<h3 id="1-2-4-ssr渲染"><a href="#1-2-4-ssr渲染" class="headerlink" title="1.2.4 ssr渲染"></a>1.2.4 ssr渲染</h3><ul>
<li><p>当有大量静态内容时候，这些内容会被当做纯字符串推进一个buffer里面，即使存在动态绑定，会通过模板插值嵌入进去。这样会比通过虚拟dom来渲染的快上很多很多。</p>
</li>
<li><p>当静态内容大到一定量级时候，会用_createStaticVNode方法在客户端生成一个static node，这些静态node，会被直接innerHTML，就不需要创建对象，然后根据对象渲染。</p>
</li>
</ul>
<h1 id="2-04项目创建——理解"><a href="#2-04项目创建——理解" class="headerlink" title="2 04项目创建——理解"></a>2 04项目创建——理解</h1><h2 id="2-1-创建Vue3的三种方式"><a href="#2-1-创建Vue3的三种方式" class="headerlink" title="2.1 创建Vue3的三种方式"></a>2.1 创建Vue3的三种方式</h2><h3 id="2-1-1-Vue-CLI"><a href="#2-1-1-Vue-CLI" class="headerlink" title="2.1.1 Vue-CLI"></a>2.1.1 Vue-CLI</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install -g @vue/cli</span><br><span class="line">vue create projectName</span><br><span class="line">cd projectName</span><br><span class="line">npm run serve</span><br></pre></td></tr></table></figure>

<h3 id="2-1-2-Webpack"><a href="#2-1-2-Webpack" class="headerlink" title="2.1.2 Webpack"></a>2.1.2 Webpack</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/vuejs/vue-next-webpack-preview.git projectName</span><br><span class="line">cd projectName</span><br><span class="line">npm install</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure>

<h3 id="2-1-3-Vite"><a href="#2-1-3-Vite" class="headerlink" title="2.1.3 Vite"></a>2.1.3 Vite</h3><h2 id="2-2-什么是Vite"><a href="#2-2-什么是Vite" class="headerlink" title="2.2  什么是Vite?"></a>2.2  什么是Vite?</h2><ul>
<li>Vite是Vue作者开发的一款意图取代webpack的工具</li>
<li>其实现原理是利用ES6的import会发送请求去加载文件的特性，拦截这些请求，做一些预编译，省去webpack冗长的打包时间</li>
</ul>
<h2 id="2-3-利用Vite创建Vue3项目"><a href="#2-3-利用Vite创建Vue3项目" class="headerlink" title="2.3 利用Vite创建Vue3项目"></a>2.3 利用Vite创建Vue3项目</h2><h3 id="2-3-1-安装Vite"><a href="#2-3-1-安装Vite" class="headerlink" title="2.3.1 安装Vite"></a>2.3.1 安装Vite</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g create-vite-app</span><br></pre></td></tr></table></figure>

<h3 id="2-3-2-创建Vue3项目"><a href="#2-3-2-创建Vue3项目" class="headerlink" title="2.3.2 创建Vue3项目"></a>2.3.2 创建Vue3项目</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create-vite-app projectName</span><br></pre></td></tr></table></figure>

<h3 id="2-3-3-安装依赖运行项目"><a href="#2-3-3-安装依赖运行项目" class="headerlink" title="2.3.3 安装依赖运行项目"></a>2.3.3 安装依赖运行项目</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd projectName</span><br><span class="line">npm install</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure>

<h2 id="2-4-Vue3-0-demo"><a href="#2-4-Vue3-0-demo" class="headerlink" title="2.4 Vue3.0 demo"></a>2.4 Vue3.0 demo</h2><ul>
<li>修改App.vue文件</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123;msg&#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;button @click&#x3D;&quot;myFn&quot;&gt;按钮&lt;&#x2F;button&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#39;App&#39;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      msg: &#39;智播渔&#39;,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    myFn() &#123;</span><br><span class="line">      alert(&#39;www.it666.com&#39;)</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/4156/20220414203750.webp"></p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/4156/20220414203840.webp"></p>
<h1 id="3-05Vue2-x存在的问题——理解"><a href="#3-05Vue2-x存在的问题——理解" class="headerlink" title="3 05Vue2.x存在的问题——理解"></a>3 05Vue2.x存在的问题——理解</h1><h2 id="3-1-todolist-demo"><a href="#3-1-todolist-demo" class="headerlink" title="3.1 todolist demo"></a>3.1 todolist demo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;form&gt;</span><br><span class="line">      &lt;input</span><br><span class="line">        type&#x3D;&quot;text&quot;</span><br><span class="line">        v-model&#x3D;&quot;stu.id&quot;</span><br><span class="line">      &#x2F;&gt;</span><br><span class="line">      &lt;input</span><br><span class="line">        type&#x3D;&quot;text&quot;</span><br><span class="line">        v-model&#x3D;&quot;stu.name&quot;</span><br><span class="line">      &#x2F;&gt;</span><br><span class="line">      &lt;input</span><br><span class="line">        type&#x3D;&quot;text&quot;</span><br><span class="line">        v-model&#x3D;&quot;stu.age&quot;</span><br><span class="line">      &#x2F;&gt;</span><br><span class="line">      &lt;input</span><br><span class="line">        type&#x3D;&quot;submit&quot;</span><br><span class="line">        @click&#x3D;&quot;addStu&quot;</span><br><span class="line">      &#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;li</span><br><span class="line">        v-for&#x3D;&quot;(stu,index) in stus&quot;</span><br><span class="line">        :key&#x3D;&quot;stu.id&quot;</span><br><span class="line">        @click&#x3D;&quot;remStu(index)&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &#123;&#123;stu.name&#125;&#125; -- &#123;&#123;stu.age&#125;&#125;</span><br><span class="line">      &lt;&#x2F;li&gt;</span><br><span class="line">    &lt;&#x2F;ul&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#39;App&#39;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      stus: [</span><br><span class="line">        &#123; id: 1, name: &#39;zs&#39;, age: 10 &#125;,</span><br><span class="line">        &#123; id: 2, name: &#39;ls&#39;, age: 20 &#125;,</span><br><span class="line">        &#123; id: 3, name: &#39;ww&#39;, age: 30 &#125;,</span><br><span class="line">      ],</span><br><span class="line">      stu: &#123;</span><br><span class="line">        id: &#39;&#39;,</span><br><span class="line">        name: &#39;&#39;,</span><br><span class="line">        age: &#39;&#39;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F; 新增功能1的数据</span><br><span class="line">    &#x2F;&#x2F; 新增功能2的数据</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    remStu(index) &#123;</span><br><span class="line">      this.stus &#x3D; this.stus.filter((stu, idx) &#x3D;&gt; idx !&#x3D; index)</span><br><span class="line">    &#125;,</span><br><span class="line">    addStu(e) &#123;</span><br><span class="line">      e.preventDefault()</span><br><span class="line">      const stu &#x3D; Object.assign(&#123;&#125;, this.stu)</span><br><span class="line">      this.stus.push(stu)</span><br><span class="line">      this.stu &#x3D; &#123;</span><br><span class="line">        id: &#39;&#39;,</span><br><span class="line">        name: &#39;&#39;,</span><br><span class="line">        age: &#39;&#39;,</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#x2F;&#x2F; 新增功能1的业务逻辑</span><br><span class="line">    &#x2F;&#x2F; 新增功能2的业务逻辑</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    &#x2F;&#x2F; 新增功能1的业务逻辑</span><br><span class="line">    &#x2F;&#x2F; 新增功能2的业务逻辑</span><br><span class="line">  &#125;,</span><br><span class="line">  watch: &#123;</span><br><span class="line">    &#x2F;&#x2F; 新增功能1的业务逻辑</span><br><span class="line">    &#x2F;&#x2F; 新增功能2的业务逻辑</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="3-2-问题"><a href="#3-2-问题" class="headerlink" title="3.2 问题"></a>3.2 问题</h2><p>数据和业务逻辑分散，不利于管理维护</p>
<h1 id="4-06-Vue3-0-组合API上-理解"><a href="#4-06-Vue3-0-组合API上-理解" class="headerlink" title="4 06-Vue3.0-组合API上-理解"></a>4 06-Vue3.0-组合API上-理解</h1><h2 id="4-1-组合API初体验-demo"><a href="#4-1-组合API初体验-demo" class="headerlink" title="4.1 组合API初体验 demo"></a>4.1 组合API初体验 demo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123;count&#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;button @click&#x3D;&quot;myFn&quot;&gt;按钮&lt;&#x2F;button&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; ref &#125; from &#39;vue&#39;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#39;App&#39;,</span><br><span class="line">  &#x2F;&#x2F; setup函数是组合API的入口函数</span><br><span class="line">  setup() &#123;</span><br><span class="line">    &#x2F;&#x2F; 定义了一个名称叫做count的变量，这个变量的初始值是0</span><br><span class="line">    &#x2F;&#x2F; 这个变量发生改变之后，Vue会自动更新UI</span><br><span class="line">    let count &#x3D; ref(0)</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 在组合API中，如果想定义方法，不用定义到methods中，直接定义即可</span><br><span class="line">    function myFn() &#123;</span><br><span class="line">      count.value +&#x3D; 1</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 注意点</span><br><span class="line">    &#x2F;&#x2F; 在组合API中定义的变量&#x2F;方法，要想在外界使用，必须通过return &#123;xxx, xxx&#125;暴露出去</span><br><span class="line">    return &#123;</span><br><span class="line">      count,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="4-2-注意点"><a href="#4-2-注意点" class="headerlink" title="4.2 注意点"></a>4.2 注意点</h2><ul>
<li><p>setup函数是组合API的入口函数</p>
</li>
<li><p>使用ref定义一个变量并设置初始值，这个变量发生改变之后，Vue会自动更新UI</p>
</li>
<li><p>ref函数只能监听简单类型的变化，不能监听复杂类型的变化（对象/数组）</p>
</li>
<li><p>在组合API中，如果想定义方法，不用定义到methods中，直接定义即可</p>
</li>
<li><p>在组合API中定义的变量/方法，要想在外界使用，必须通过return {xxx, xxx}暴露出去</p>
</li>
</ul>
<h1 id="5-07组合API中——理解"><a href="#5-07组合API中——理解" class="headerlink" title="5 07组合API中——理解"></a>5 07组合API中——理解</h1><h2 id="5-1-业务抽离demo"><a href="#5-1-业务抽离demo" class="headerlink" title="5.1 业务抽离demo"></a>5.1 业务抽离demo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;li</span><br><span class="line">        v-for&#x3D;&quot;(stu,index) in state.stus&quot;</span><br><span class="line">        :key&#x3D;&quot;stu.id&quot;</span><br><span class="line">        @click&#x3D;&quot;remStu(index)&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &#123;&#123;stu.name&#125;&#125; -- &#123;&#123;stu.age&#125;&#125;</span><br><span class="line">      &lt;&#x2F;li&gt;</span><br><span class="line">    &lt;&#x2F;ul&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; reactive &#125; from &#39;vue&#39;</span><br><span class="line"></span><br><span class="line">function useRemoveStudent() &#123;</span><br><span class="line">  let state &#x3D; reactive(&#123;</span><br><span class="line">    stus: [</span><br><span class="line">      &#123; id: 1, name: &#39;zs&#39;, age: 10 &#125;,</span><br><span class="line">      &#123; id: 2, name: &#39;ls&#39;, age: 20 &#125;,</span><br><span class="line">      &#123; id: 3, name: &#39;ww&#39;, age: 30 &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  function remStu(index) &#123;</span><br><span class="line">    state.stus &#x3D; state.stus.filter((stu, idx) &#x3D;&gt; idx !&#x3D; index)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return &#123; state, remStu &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#39;App&#39;,</span><br><span class="line">  setup() &#123;</span><br><span class="line"></span><br><span class="line">    let &#123; state, remStu &#125; &#x3D; useRemoveStudent()</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">      state,</span><br><span class="line">      remStu,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="5-2-理解"><a href="#5-2-理解" class="headerlink" title="5.2 理解"></a>5.2 理解</h2><p>删除用户的业务代码被抽离到了useRemoveStudent中，利于之后的管理和维护</p>
<h1 id="6-08组合API下——理解"><a href="#6-08组合API下——理解" class="headerlink" title="6 08组合API下——理解"></a>6 08组合API下——理解</h1><h2 id="6-1-多文件demo"><a href="#6-1-多文件demo" class="headerlink" title="6.1 多文件demo"></a>6.1 多文件demo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;form&gt;</span><br><span class="line">      &lt;input</span><br><span class="line">        type&#x3D;&quot;text&quot;</span><br><span class="line">        v-model&#x3D;&quot;state2.stu.id&quot;</span><br><span class="line">      &#x2F;&gt;</span><br><span class="line">      &lt;input</span><br><span class="line">        type&#x3D;&quot;text&quot;</span><br><span class="line">        v-model&#x3D;&quot;state2.stu.name&quot;</span><br><span class="line">      &#x2F;&gt;</span><br><span class="line">      &lt;input</span><br><span class="line">        type&#x3D;&quot;text&quot;</span><br><span class="line">        v-model&#x3D;&quot;state2.stu.age&quot;</span><br><span class="line">      &#x2F;&gt;</span><br><span class="line">      &lt;input</span><br><span class="line">        type&#x3D;&quot;submit&quot;</span><br><span class="line">        @click&#x3D;&quot;addStu&quot;</span><br><span class="line">      &#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;li</span><br><span class="line">        v-for&#x3D;&quot;(stu,index) in state.stus&quot;</span><br><span class="line">        :key&#x3D;&quot;stu.id&quot;</span><br><span class="line">        @click&#x3D;&quot;remStu(index)&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &#123;&#123;stu.name&#125;&#125; -- &#123;&#123;stu.age&#125;&#125;</span><br><span class="line">      &lt;&#x2F;li&gt;</span><br><span class="line">    &lt;&#x2F;ul&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; reactive &#125; from &#39;vue&#39;</span><br><span class="line">import useAddStudent from &#39;.&#x2F;js&#x2F;add&#39;</span><br><span class="line">import useRemoveStudent from &#39;.&#x2F;js&#x2F;remove&#39;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#39;App&#39;,</span><br><span class="line">  setup() &#123;</span><br><span class="line">    let &#123; state, remStu &#125; &#x3D; useRemoveStudent()</span><br><span class="line">    let &#123; state2, addStu &#125; &#x3D; useAddStudent(state)</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">      state,</span><br><span class="line">      remStu,</span><br><span class="line">      state2,</span><br><span class="line">      addStu,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; reactive &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">useRemoveStudent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> state = reactive(&#123;</span><br><span class="line">    stus: [</span><br><span class="line">      &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;zs&#x27;</span>, <span class="attr">age</span>: <span class="number">10</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;ls&#x27;</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">name</span>: <span class="string">&#x27;ww&#x27;</span>, <span class="attr">age</span>: <span class="number">30</span> &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">remStu</span>(<span class="params">index</span>) </span>&#123;</span><br><span class="line">    state.stus = state.stus.filter(<span class="function">(<span class="params">stu, idx</span>) =&gt;</span> idx != index)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123; state, remStu &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useRemoveStudent</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; reactive &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">useAddStudent</span> (<span class="params">state</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> state2 = reactive(&#123;</span><br><span class="line">    stu: &#123;</span><br><span class="line">      id: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">      name: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">      age: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">addStu</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    e.preventDefault()</span><br><span class="line">    <span class="keyword">const</span> stu = <span class="built_in">Object</span>.assign(&#123;&#125;, state2.stu)</span><br><span class="line">    state.stus.push(stu)</span><br><span class="line">    state2.stu = &#123;</span><br><span class="line">      id: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">      name: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">      age: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123; state2, addStu &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useAddStudent</span><br></pre></td></tr></table></figure>

<h2 id="6-2-理解"><a href="#6-2-理解" class="headerlink" title="6.2 理解"></a>6.2 理解</h2><p>所有的功能都可以放到独立的模块中去管理</p>
<h1 id="7-09来点动力——理解"><a href="#7-09来点动力——理解" class="headerlink" title="7 09来点动力——理解"></a>7 09来点动力——理解</h1><p>Vue2.0 按照操作划分代码块，Vue3.0 按业务划分代码块</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/4156/20220414210018.webp"></p>
<h1 id="8-10-Vue3-0-组合API本质-理解-amp-amp-11-Vue3-0-setup执行时机和注意点-理解"><a href="#8-10-Vue3-0-组合API本质-理解-amp-amp-11-Vue3-0-setup执行时机和注意点-理解" class="headerlink" title="8 10-Vue3.0-组合API本质-理解&amp;&amp;11-Vue3.0-setup执行时机和注意点-理解"></a>8 10-Vue3.0-组合API本质-理解&amp;&amp;11-Vue3.0-setup执行时机和注意点-理解</h1><h2 id="8-1-Composition-API-和-Option-API-混合使用"><a href="#8-1-Composition-API-和-Option-API-混合使用" class="headerlink" title="8.1 Composition API 和 Option API 混合使用"></a>8.1 Composition API 和 Option API 混合使用</h2><p>Composition API 和 Option API可以混合使用</p>
<h3 id="8-1-1-混合使用demo"><a href="#8-1-1-混合使用demo" class="headerlink" title="8.1.1 混合使用demo"></a>8.1.1 混合使用demo</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123;name&#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;button @click&#x3D;&quot;myFn1&quot;&gt;按钮&lt;&#x2F;button&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123;age&#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;button @click&#x3D;&quot;myFn2&quot;&gt;按钮&lt;&#x2F;button&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; ref &#125; from &#39;vue&#39;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#39;App&#39;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      name: &#39;lnj&#39;,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    myFn1() &#123;</span><br><span class="line">      alert(&#39;abc&#39;)</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  setup() &#123;</span><br><span class="line">    let age &#x3D; ref(18)</span><br><span class="line">    function myFn2() &#123;</span><br><span class="line">      alert(&#39;sxx&#39;)</span><br><span class="line">    &#125;</span><br><span class="line">    return &#123;</span><br><span class="line">      age,</span><br><span class="line">      myFn2,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="8-2-Composition-API本质（组合API-注入API）"><a href="#8-2-Composition-API本质（组合API-注入API）" class="headerlink" title="8.2  Composition API本质（组合API/注入API）"></a>8.2  Composition API本质（组合API/注入API）</h2><p>Composition API的本质就是在运行的时候将暴露出去的数据注入到option api中，如将数据注入到data中，将方法注入到methods中。</p>
<h2 id="8-3-setup执行时机"><a href="#8-3-setup执行时机" class="headerlink" title="8.3 setup执行时机"></a>8.3 setup执行时机</h2><p>setup在beforeCreate和created两个生命周期之间执行</p>
<ul>
<li>beforeCreate: 表示组件刚刚被创建出来，组件的data和methods还没有初始化好</li>
<li>setup</li>
<li>created: data和methods已经初始化好</li>
</ul>
<h2 id="8-4-setup注意点"><a href="#8-4-setup注意点" class="headerlink" title="8.4 setup注意点"></a>8.4 setup注意点</h2><ul>
<li>由于在执行setup函数的时候，还没有执行created生命周期方法，所以在setup函数中，是无法使用data和methods</li>
<li>由于我们不能在setup函数中无法使用data和methods，所以Vue为了避免我们错误的使用，它直接将函数中的this修改成了<strong>undefined</strong></li>
<li>setup函数只能是同步的，不能是异步的</li>
</ul>
<h1 id="9-12reactive-理解"><a href="#9-12reactive-理解" class="headerlink" title="9 12reactive-理解"></a>9 12reactive-理解</h1><h2 id="9-1-什么是reactive"><a href="#9-1-什么是reactive" class="headerlink" title="9.1 什么是reactive"></a>9.1 什么是reactive</h2><ul>
<li>reactive是Vue3中提供的实现响应式数据的方法</li>
<li>在Vue2中响应式数据是通过defineProperty来实现的，而在Vue3中响应式数据是通过ES6的Proxy来实现的</li>
</ul>
<h2 id="9-2-reactiv注意点"><a href="#9-2-reactiv注意点" class="headerlink" title="9.2 reactiv注意点"></a>9.2 reactiv注意点</h2><ul>
<li>reactive参数必须是对象（json/arr）</li>
<li>如果给reactive传递了其他对象<ul>
<li>默认情况下修改对象，界面不会自动更新</li>
<li>如果想更新，可以通过重新赋值的方式</li>
</ul>
</li>
</ul>
<h3 id="9-2-1-给reactive传递非对象无法实现响应式"><a href="#9-2-1-给reactive传递非对象无法实现响应式" class="headerlink" title="9.2.1 给reactive传递非对象无法实现响应式"></a>9.2.1 给reactive传递非对象无法实现响应式</h3><p>点击按钮值发生变化但页面将不会发生变化</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123;state&#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;button @click&#x3D;&quot;myFn&quot;&gt;按钮&lt;&#x2F;button&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; reactive &#125; from &#39;vue&#39;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#39;App&#39;,</span><br><span class="line">  setup() &#123;</span><br><span class="line">    &#x2F;&#x2F; 创建一个响应式数据</span><br><span class="line">    &#x2F;&#x2F; 本质：就是将传入的数据包装成一个Proxy对象</span><br><span class="line">    let state &#x3D; reactive(123)</span><br><span class="line"></span><br><span class="line">    function myFn() &#123;</span><br><span class="line">      state &#x3D; 666 &#x2F;&#x2F; 由于在创建响应式数据的时候传递的不是一个对象，所以无法实现响应式</span><br><span class="line">      console.log(state)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">      state,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="9-2-2-需要传递一个对象才可以实现响应式"><a href="#9-2-2-需要传递一个对象才可以实现响应式" class="headerlink" title="9.2.2 需要传递一个对象才可以实现响应式"></a>9.2.2 需要传递一个对象才可以实现响应式</h3><p>点击按钮页面将发生变化</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123;state.age&#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;button @click&#x3D;&quot;myFn&quot;&gt;按钮&lt;&#x2F;button&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; reactive &#125; from &#39;vue&#39;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#39;App&#39;,</span><br><span class="line">  setup() &#123;</span><br><span class="line">    let state &#x3D; reactive(&#123;</span><br><span class="line">      age: 123,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    function myFn() &#123;</span><br><span class="line">      state.age &#x3D; 666</span><br><span class="line">      console.log(state)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">      state,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="9-2-3-数组也可以监听"><a href="#9-2-3-数组也可以监听" class="headerlink" title="9.2.3 数组也可以监听"></a>9.2.3 数组也可以监听</h3><p>点击按钮修改数组的值将发现页面发生变化</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123;state&#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;button @click&#x3D;&quot;myFn&quot;&gt;按钮&lt;&#x2F;button&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; reactive &#125; from &#39;vue&#39;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#39;App&#39;,</span><br><span class="line">  setup() &#123;</span><br><span class="line">    let state &#x3D; reactive([1, 3, 5])</span><br><span class="line"></span><br><span class="line">    function myFn() &#123;</span><br><span class="line">      state[0] &#x3D; 666</span><br><span class="line">      console.log(state)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">      state,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h5 id="4-其他对象不能实现响应式，需要重新赋值"><a href="#4-其他对象不能实现响应式，需要重新赋值" class="headerlink" title="4. 其他对象不能实现响应式，需要重新赋值"></a>4. 其他对象不能实现响应式，需要重新赋值</h5><p>调用Date自带的方法不能实现响应式，需要使用注释的方法实现</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.time&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myFn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; reactive &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> state = reactive(&#123;</span></span><br><span class="line"><span class="javascript">      time: <span class="keyword">new</span> <span class="built_in">Date</span>(),</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">myFn</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="comment">// const newTime = new Date(state.time.getTime())</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// newTime.setDate(newTime.getDate() + 1)</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// state.time = newTime</span></span></span><br><span class="line">      state.time.setDate(state.time.getDate() + 1)</span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state.time)</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      state,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="13-Vue3-0-ref-理解"><a href="#13-Vue3-0-ref-理解" class="headerlink" title="13-Vue3.0-ref-理解"></a>13-Vue3.0-ref-理解</h3><h4 id="一、什么是ref"><a href="#一、什么是ref" class="headerlink" title="一、什么是ref"></a>一、什么是ref</h4><ul>
<li>ref和reactive一样，也是用来实现响应式数据的方法</li>
<li>由于reactive必须传递一个对象，所以导致在企业开发中如果我们只想让某个变量实现响应式的时候会非常麻烦，所以Vue3就给我们提供了ref方法，实现对简单值的监听</li>
</ul>
<h4 id="二、ref本质"><a href="#二、ref本质" class="headerlink" title="二、ref本质"></a>二、ref本质</h4><ul>
<li>ref底层的本质其实还是reactive，系统会自动根据我们给ref传入的值将它转换成<code>ref(xx) -&gt; reactive(&#123;value: xx&#125;)</code></li>
</ul>
<h4 id="三、ref注意点"><a href="#三、ref注意点" class="headerlink" title="三、ref注意点"></a>三、ref注意点</h4><ul>
<li>在template中使用ref的值不用通过value获取</li>
<li>在js中使用ref的值必须通过value获取</li>
</ul>
<ol>
<li>js中加value，template中不需要加value</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;age&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myFn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> age = ref(<span class="number">18</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">myFn</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line">      age.value = 666</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      age,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="14-Vue3-0-ref和reactive区别-理解"><a href="#14-Vue3-0-ref和reactive区别-理解" class="headerlink" title="14-Vue3.0-ref和reactive区别-理解"></a>14-Vue3.0-ref和reactive区别-理解</h3><h4 id="一、Vue在处理的时候会先判断数据是什么类型的"><a href="#一、Vue在处理的时候会先判断数据是什么类型的" class="headerlink" title="一、Vue在处理的时候会先判断数据是什么类型的"></a>一、Vue在处理的时候会先判断数据是什么类型的</h4><ul>
<li>如果在template里面使用的是ref类型的数据，那么Vue会自动帮我们添加.value</li>
<li>如果template里使用的是reactive类型的数据，那么Vue不会自动帮我们添加.value</li>
</ul>
<h4 id="二、Vue是如何判断数据类型的呢"><a href="#二、Vue是如何判断数据类型的呢" class="headerlink" title="二、Vue是如何判断数据类型的呢"></a>二、Vue是如何判断数据类型的呢</h4><h5 id="1-打印ref数据的结果"><a href="#1-打印ref数据的结果" class="headerlink" title="1. 打印ref数据的结果"></a>1. 打印ref数据的结果</h5><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">RefImpl &#123;_rawValue: <span class="number">18</span>, _shallow: <span class="literal">false</span>, __v_isRef: <span class="literal">true</span>, _value: <span class="number">18</span>&#125;</span><br><span class="line">__v_isRef: <span class="literal">true</span></span><br><span class="line">_rawValue: <span class="number">18</span></span><br><span class="line">_shallow: <span class="literal">false</span></span><br><span class="line">_value: <span class="number">18</span></span><br><span class="line"><span class="keyword">value</span>: <span class="number">18</span></span><br></pre></td></tr></table></figure>

<h5 id="2-解释"><a href="#2-解释" class="headerlink" title="2. 解释"></a>2. 解释</h5><ul>
<li>Vue在解析数据之前，会自动判断这个数据是否是 ref 类型的，如果是就自动添加 .value ，如果不是就不自动添加 .value</li>
<li>通过当前数据的 __v_isRef 来判断，如果有这个私有属性，并且取值为true，那么就代表是一个ref类型的数据</li>
</ul>
<h4 id="三、isRef和isReactive"><a href="#三、isRef和isReactive" class="headerlink" title="三、isRef和isReactive"></a>三、isRef和isReactive</h4><p>通过 isRef 和 isReactive 可以判断数据是 ref 还是 reactive</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;age&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myFn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; ref, isRef, isReactive, reactive &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> age = ref(<span class="number">18</span>)</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> state = reactive(&#123; <span class="attr">age</span>: <span class="number">18</span> &#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">myFn</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(isRef(age))</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(isRef(state))</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(isReactive(age))</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(isReactive(state))</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      age,</span><br><span class="line">      state,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="15-Vue3-0-递归监听理解"><a href="#15-Vue3-0-递归监听理解" class="headerlink" title="15-Vue3.0-递归监听理解"></a>15-Vue3.0-递归监听理解</h3><h4 id="一、递归监听"><a href="#一、递归监听" class="headerlink" title="一、递归监听"></a>一、递归监听</h4><p>默认情况下，无论是通过ref还是通过reactive都是递归监听</p>
<h5 id="1-reactive递归监听"><a href="#1-reactive递归监听" class="headerlink" title="1. reactive递归监听"></a>1. reactive递归监听</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.a&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.gf.b&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.gf.f.c&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.gf.f.s.d&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myFn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; reactive &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> state = reactive(&#123;</span></span><br><span class="line"><span class="javascript">      a: <span class="string">&#x27;a&#x27;</span>,</span></span><br><span class="line">      gf: &#123;</span><br><span class="line"><span class="javascript">        b: <span class="string">&#x27;b&#x27;</span>,</span></span><br><span class="line">        f: &#123;</span><br><span class="line"><span class="javascript">          c: <span class="string">&#x27;c&#x27;</span>,</span></span><br><span class="line">          s: &#123;</span><br><span class="line"><span class="javascript">            d: <span class="string">&#x27;d&#x27;</span>,</span></span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">myFn</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      state.a = <span class="string">&#x27;1&#x27;</span></span></span><br><span class="line"><span class="javascript">      state.gf.b = <span class="string">&#x27;2&#x27;</span></span></span><br><span class="line"><span class="javascript">      state.gf.f.c = <span class="string">&#x27;3&#x27;</span></span></span><br><span class="line"><span class="javascript">      state.gf.f.s.d = <span class="string">&#x27;4&#x27;</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      state,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="2-ref递归监听"><a href="#2-ref递归监听" class="headerlink" title="2. ref递归监听"></a>2. ref递归监听</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.a&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.gf.b&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.gf.f.c&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.gf.f.s.d&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myFn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> state = ref(&#123;</span></span><br><span class="line"><span class="javascript">      a: <span class="string">&#x27;a&#x27;</span>,</span></span><br><span class="line">      gf: &#123;</span><br><span class="line"><span class="javascript">        b: <span class="string">&#x27;b&#x27;</span>,</span></span><br><span class="line">        f: &#123;</span><br><span class="line"><span class="javascript">          c: <span class="string">&#x27;c&#x27;</span>,</span></span><br><span class="line">          s: &#123;</span><br><span class="line"><span class="javascript">            d: <span class="string">&#x27;d&#x27;</span>,</span></span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">myFn</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      state.value.a = <span class="string">&#x27;1&#x27;</span></span></span><br><span class="line"><span class="javascript">      state.value.gf.b = <span class="string">&#x27;2&#x27;</span></span></span><br><span class="line"><span class="javascript">      state.value.gf.f.c = <span class="string">&#x27;3&#x27;</span></span></span><br><span class="line"><span class="javascript">      state.value.gf.f.s.d = <span class="string">&#x27;4&#x27;</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      state,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="二、递归监听存在的问题"><a href="#二、递归监听存在的问题" class="headerlink" title="二、递归监听存在的问题"></a>二、递归监听存在的问题</h4><p>如果数据量比较大，非常消耗性能<br> 因为递归监听将使每一层都被包装成一个Proxy</p>
<h5 id="1-递归监听验证"><a href="#1-递归监听验证" class="headerlink" title="1. 递归监听验证"></a>1. 递归监听验证</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.a&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.gf.b&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.gf.f.c&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.gf.f.s.d&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myFn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; reactive &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> state = reactive(&#123;</span></span><br><span class="line"><span class="javascript">      a: <span class="string">&#x27;a&#x27;</span>,</span></span><br><span class="line">      gf: &#123;</span><br><span class="line"><span class="javascript">        b: <span class="string">&#x27;b&#x27;</span>,</span></span><br><span class="line">        f: &#123;</span><br><span class="line"><span class="javascript">          c: <span class="string">&#x27;c&#x27;</span>,</span></span><br><span class="line">          s: &#123;</span><br><span class="line"><span class="javascript">            d: <span class="string">&#x27;d&#x27;</span>,</span></span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">myFn</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state)</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state.gf)</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state.gf.f)</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state.gf.f.s)</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      state,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>点击按钮看到控制台的输出</p>
<p><img src="https://upload-images.jianshu.io/upload_images/1907212-11a2115947c5003f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/282/format/webp" alt="img"></p>
<p>image.png</p>
<h3 id="16-Vue3-0-非递归监听-掌握"><a href="#16-Vue3-0-非递归监听-掌握" class="headerlink" title="16-Vue3.0-非递归监听-掌握"></a>16-Vue3.0-非递归监听-掌握</h3><h4 id="一、非递归监听"><a href="#一、非递归监听" class="headerlink" title="一、非递归监听"></a>一、非递归监听</h4><h5 id="1-shallowReactive"><a href="#1-shallowReactive" class="headerlink" title="1. shallowReactive"></a>1. shallowReactive</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.a&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.gf.b&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.gf.f.c&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.gf.f.s.d&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myFn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; shallowReactive &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> state = shallowReactive(&#123;</span></span><br><span class="line"><span class="javascript">      a: <span class="string">&#x27;a&#x27;</span>,</span></span><br><span class="line">      gf: &#123;</span><br><span class="line"><span class="javascript">        b: <span class="string">&#x27;b&#x27;</span>,</span></span><br><span class="line">        f: &#123;</span><br><span class="line"><span class="javascript">          c: <span class="string">&#x27;c&#x27;</span>,</span></span><br><span class="line">          s: &#123;</span><br><span class="line"><span class="javascript">            d: <span class="string">&#x27;d&#x27;</span>,</span></span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">myFn</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="comment">// state.a = &#x27;1&#x27;</span></span></span><br><span class="line"><span class="javascript">      state.gf.b = <span class="string">&#x27;2&#x27;</span></span></span><br><span class="line"><span class="javascript">      state.gf.f.c = <span class="string">&#x27;3&#x27;</span></span></span><br><span class="line"><span class="javascript">      state.gf.f.s.d = <span class="string">&#x27;4&#x27;</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state)</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state.gf)</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state.gf.f)</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state.gf.f.s)</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      state,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>点击按钮页面将不会发生变化，查看控制台将看到以下打印结果</p>
<p><img src="https://upload-images.jianshu.io/upload_images/1907212-c4b69db8d51a9467.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/262/format/webp" alt="img"></p>
<p>image.png</p>
<p>发现除了第一层之外其它层没有被包装成Proxy</p>
<h5 id="2-shallowRef"><a href="#2-shallowRef" class="headerlink" title="2. shallowRef"></a>2. shallowRef</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.a&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.gf.b&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.gf.f.c&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.gf.f.s.d&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myFn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; shallowRef &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> state = shallowRef(&#123;</span></span><br><span class="line"><span class="javascript">      a: <span class="string">&#x27;a&#x27;</span>,</span></span><br><span class="line">      gf: &#123;</span><br><span class="line"><span class="javascript">        b: <span class="string">&#x27;b&#x27;</span>,</span></span><br><span class="line">        f: &#123;</span><br><span class="line"><span class="javascript">          c: <span class="string">&#x27;c&#x27;</span>,</span></span><br><span class="line">          s: &#123;</span><br><span class="line"><span class="javascript">            d: <span class="string">&#x27;d&#x27;</span>,</span></span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">myFn</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      state.value.a = <span class="string">&#x27;1&#x27;</span></span></span><br><span class="line"><span class="javascript">      state.value.gf.b = <span class="string">&#x27;2&#x27;</span></span></span><br><span class="line"><span class="javascript">      state.value.gf.f.c = <span class="string">&#x27;3&#x27;</span></span></span><br><span class="line"><span class="javascript">      state.value.gf.f.s.d = <span class="string">&#x27;4&#x27;</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state)</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state.value)</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state.value.gf)</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state.value.gf.f)</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state.value.gf.f.s)</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      state,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>点击按钮页面将不会发生变化，查看控制台将看到以下打印结果</p>
<p><img src="https://upload-images.jianshu.io/upload_images/1907212-edef292c0e152c7d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/508/format/webp" alt="img"></p>
<p>image.png</p>
<p> 发现除了第一层之外所有层均没有被包装<br><strong>注意：</strong>  如果是通过shallowRef创建数据，nameVue监听的是.value的变化，并不是第一层的变化</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.a&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.gf.b&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.gf.f.c&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.gf.f.s.d&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myFn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; shallowRef &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> state = shallowRef(&#123;</span></span><br><span class="line"><span class="javascript">      a: <span class="string">&#x27;a&#x27;</span>,</span></span><br><span class="line">      gf: &#123;</span><br><span class="line"><span class="javascript">        b: <span class="string">&#x27;b&#x27;</span>,</span></span><br><span class="line">        f: &#123;</span><br><span class="line"><span class="javascript">          c: <span class="string">&#x27;c&#x27;</span>,</span></span><br><span class="line">          s: &#123;</span><br><span class="line"><span class="javascript">            d: <span class="string">&#x27;d&#x27;</span>,</span></span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">myFn</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line">      state.value = &#123;</span><br><span class="line"><span class="javascript">        a: <span class="string">&#x27;1&#x27;</span>,</span></span><br><span class="line">        gf: &#123;</span><br><span class="line"><span class="javascript">          b: <span class="string">&#x27;2&#x27;</span>,</span></span><br><span class="line">          f: &#123;</span><br><span class="line"><span class="javascript">            c: <span class="string">&#x27;3&#x27;</span>,</span></span><br><span class="line">            s: &#123;</span><br><span class="line"><span class="javascript">              d: <span class="string">&#x27;4&#x27;</span>,</span></span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      state,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>点击按钮发现页面发生变化了</p>
<h5 id="3-triggerRef"><a href="#3-triggerRef" class="headerlink" title="3. triggerRef"></a>3. triggerRef</h5><p>采用非递归监听如果想监听第四层的数据，可以使用triggerRef根据传入的数据主动更新界面</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.a&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.gf.b&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.gf.f.c&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.gf.f.s.d&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myFn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; shallowRef, triggerRef &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> state = shallowRef(&#123;</span></span><br><span class="line"><span class="javascript">      a: <span class="string">&#x27;a&#x27;</span>,</span></span><br><span class="line">      gf: &#123;</span><br><span class="line"><span class="javascript">        b: <span class="string">&#x27;b&#x27;</span>,</span></span><br><span class="line">        f: &#123;</span><br><span class="line"><span class="javascript">          c: <span class="string">&#x27;c&#x27;</span>,</span></span><br><span class="line">          s: &#123;</span><br><span class="line"><span class="javascript">            d: <span class="string">&#x27;d&#x27;</span>,</span></span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">myFn</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      state.value.gf.f.s.d = <span class="string">&#x27;4&#x27;</span></span></span><br><span class="line">      triggerRef(state)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      state,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>点击按钮发现第四层的数据发生了变化<br> <strong>注意：</strong> Vue3只提供了triggerRef方法，没有提供triggerReactive方法，所以如果是reactive类型的数据，那么是无法主动触发界面更新的</p>
<h3 id="17-Vue3-0-shallowRef本质"><a href="#17-Vue3-0-shallowRef本质" class="headerlink" title="17-Vue3.0-shallowRef本质"></a>17-Vue3.0-shallowRef本质</h3><p><code>ref-&gt;reactive</code><br> <code>ref(10)-&gt;reactive(&#123;value: 10&#125;)</code><br> <code>shallowRef-&gt;shallowReactive</code><br> <code>shallowRef(10)-&gt;shallowReactive(&#123;value: 10&#125;)</code><br> 所以如果是通过shallowRef创建的数据，它监听的是.value的变化，因为底层本质上value才是第一层</p>
<h3 id="18-Vue3-0-toRaw-amp-amp-19-Vue3-0-toRaw"><a href="#18-Vue3-0-toRaw-amp-amp-19-Vue3-0-toRaw" class="headerlink" title="18-Vue3.0-toRaw &amp;&amp; 19-Vue3.0-toRaw"></a>18-Vue3.0-toRaw &amp;&amp; 19-Vue3.0-toRaw</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myFn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; reactive &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> obj = &#123;</span></span><br><span class="line"><span class="javascript">      name: <span class="string">&#x27;lnj&#x27;</span>,</span></span><br><span class="line">      age: 18,</span><br><span class="line">    &#125;</span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> state = reactive(obj)</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(obj === state) <span class="comment">// false</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="comment">// state和obj的关系</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 引用关系，state的本质是一个Proxy对象，在这个Proxy对象引用了obj</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">myFn</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 如果直接修改obj，那么是无法触发界面更新的，只有通过包装之后的对象来修改，才会触发界面的更新</span></span></span><br><span class="line"><span class="javascript">      obj.name = <span class="string">&#x27;zs&#x27;</span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state)</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      state,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="一、toRaw"><a href="#一、toRaw" class="headerlink" title="一、toRaw"></a>一、toRaw</h4><p>从reactive或ref中得到原始数据</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; reactive, toRaw &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> obj = &#123;</span></span><br><span class="line"><span class="javascript">      name: <span class="string">&#x27;lnj&#x27;</span>,</span></span><br><span class="line">      age: 18,</span><br><span class="line">    &#125;</span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> state = reactive(obj)</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> obj2 = toRaw(state)</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(obj === obj2)</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      state,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>控制台打印true</p>
<h4 id="二、toRaw作用"><a href="#二、toRaw作用" class="headerlink" title="二、toRaw作用"></a>二、toRaw作用</h4><p>做一些不想被监听的事情（提升性能）</p>
<p>ref/reactive数据类型的特点：每次修改都会被追踪，都会更新UI界面，但是这样其实是非常消耗性能的，所以如果我们有一些操作不需要追踪，不需要更新UI界面，那么这个时候，我们就可以通过toRaw方法拿到它的原始数据，对原始数据进行修改，这样就不会被追踪，这样就不会更新UI界面，这样性能就好了</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myFn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; reactive, toRaw &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> obj = &#123;</span></span><br><span class="line"><span class="javascript">      name: <span class="string">&#x27;lnj&#x27;</span>,</span></span><br><span class="line">      age: 18,</span><br><span class="line">    &#125;</span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> state = reactive(obj)</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> obj2 = toRaw(state)</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(obj === obj2)</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">myFn</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      obj2.name = <span class="string">&#x27;zs&#x27;</span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state)</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      state,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>点击按钮发现数据发生了改变，但界面没有发生改变</p>
<h4 id="三、ref的toRaw"><a href="#三、ref的toRaw" class="headerlink" title="三、ref的toRaw"></a>三、ref的toRaw</h4><p>如果想通过toRaw拿到ref类型的原始数据（创建时传入的那个数据），那么就必须明确告诉toRaw方法，要获取的是.value的值，因为经过Vue处理之后.value中保存的才是当初创建时传入的那个原始数据</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myFn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; ref, toRaw &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> obj = &#123;</span></span><br><span class="line"><span class="javascript">      name: <span class="string">&#x27;lnj&#x27;</span>,</span></span><br><span class="line">      age: 18,</span><br><span class="line">    &#125;</span><br><span class="line"><span class="javascript">    <span class="comment">// ref本质：reactive</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// ref(obj) -&gt; reactive(&#123;value: obj&#125;)</span></span></span><br><span class="line">    </span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> state = ref(obj)</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> obj2 = toRaw(state.value)</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(obj === obj2)</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">myFn</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      obj2.name = <span class="string">&#x27;zs&#x27;</span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state)</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      state,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="20-Vue3-0-markRaw"><a href="#20-Vue3-0-markRaw" class="headerlink" title="20-Vue3.0-markRaw"></a>20-Vue3.0-markRaw</h3><p>markRaw标记某个数据永远不会被追踪</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myFn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; markRaw, reactive &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> obj = &#123;</span></span><br><span class="line"><span class="javascript">      name: <span class="string">&#x27;lnj&#x27;</span>,</span></span><br><span class="line">      age: 18,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    obj = markRaw(obj)</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> state = reactive(obj)</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">myFn</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      state.name = <span class="string">&#x27;zs&#x27;</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      state,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>点击按钮数据不会发生变化</p>
<h3 id="21-Vue3-0-toRef-理解"><a href="#21-Vue3-0-toRef-理解" class="headerlink" title="21-Vue3.0-toRef-理解"></a>21-Vue3.0-toRef-理解</h3><h4 id="一、toRef的理解"><a href="#一、toRef的理解" class="headerlink" title="一、toRef的理解"></a>一、toRef的理解</h4><ul>
<li>如果利用ref将某一个对象中的属性变成响应式的数据， 我们修改响应式数据是不会影响到原始数据的。</li>
<li>如果利用toRef将某一个对象中的属性变成响应式的数据，我们修改响应式数据是会影响到原始数据的</li>
<li>但是如果响应式数据是通过toRef创建的，那么修改了数据并不会触发UI界面的更新</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myFn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; toRef &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> obj = &#123;</span></span><br><span class="line"><span class="javascript">      name: <span class="string">&#x27;lnj&#x27;</span>,</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> state = toRef(obj, <span class="string">&#x27;name&#x27;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">myFn</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      state.value = <span class="string">&#x27;zs&#x27;</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state)</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(obj)</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      state,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>点击按钮发现数据与原始数据都发生了变化</p>
<h4 id="二、ref和toRef区别"><a href="#二、ref和toRef区别" class="headerlink" title="二、ref和toRef区别"></a>二、ref和toRef区别</h4><ul>
<li>ref-&gt;复制，修改响应式数据不会影响以前的数据</li>
<li>toRef-&gt;引用，修改响应式数据会影响以前的数据</li>
<li>ref-&gt;数据发生改变，界面就会自动更新</li>
<li>toRef-&gt;数据发生改变，界面也不会自动更新</li>
</ul>
<h4 id="三、toRef引用场景"><a href="#三、toRef引用场景" class="headerlink" title="三、toRef引用场景"></a>三、toRef引用场景</h4><p>如果想让响应式数据和以前的数据关联起来，并且更新响应式数据之后还不想更新UI，name就可以使用toRef。</p>
<h3 id="22-Vue3-0-toRefs-理解"><a href="#22-Vue3-0-toRefs-理解" class="headerlink" title="22-Vue3.0-toRefs-理解"></a>22-Vue3.0-toRefs-理解</h3><p>将对象中所有的属性全部追踪</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myFn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; toRefs &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> obj = &#123;</span></span><br><span class="line"><span class="javascript">      name: <span class="string">&#x27;lnj&#x27;</span>,</span></span><br><span class="line">      age:18</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> state = toRefs(obj)</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">myFn</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      state.name.value = <span class="string">&#x27;zs&#x27;</span></span></span><br><span class="line">      state.age.value = 666</span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state)</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(obj)</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      state,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>点击按钮发现数据和原始数据都发生了变化</p>
<h3 id="23-Vue3-0-customRef-上-理解-amp-amp-24-Vue3-0-customRef-下-理解"><a href="#23-Vue3-0-customRef-上-理解-amp-amp-24-Vue3-0-customRef-下-理解" class="headerlink" title="23-Vue3.0-customRef 上-理解 &amp;&amp; 24-Vue3.0-customRef 下-理解"></a>23-Vue3.0-customRef 上-理解 &amp;&amp; 24-Vue3.0-customRef 下-理解</h3><h4 id="一、customRef"><a href="#一、customRef" class="headerlink" title="一、customRef"></a>一、customRef</h4><p>返回一个ref对象，可以显式地控制依赖追踪和触发响应</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;age&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myFn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; customRef &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">myRef</span>(<span class="params">value</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">return</span> customRef(<span class="function">(<span class="params">track, trigger</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">get</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        track() <span class="comment">// 告诉Vue这个数据需要追踪变化</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">&#x27;get&#x27;</span>, value)</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> value</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">set</span>(<span class="params">newValue</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">&#x27;set&#x27;</span>, newValue)</span></span><br><span class="line">        value = newValue</span><br><span class="line"><span class="javascript">        trigger() <span class="comment">// 告诉Vue触发界面更新</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> age = myRef(<span class="number">18</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">myFn</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line">      age.value += 1</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      age,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="二、为什么要使用customRef"><a href="#二、为什么要使用customRef" class="headerlink" title="二、为什么要使用customRef"></a>二、为什么要使用customRef</h4><p>一个使用customRef的场景，根据数据的请求路径进行追踪</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    &lt;li</span><br><span class="line">      v-for=&quot;item in state&quot;</span><br><span class="line">      :key=&quot;item.id&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &#123;&#123;item.name&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; customRef &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">myRef</span>(<span class="params">path, initValue</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">let</span> value = initValue</span></span><br><span class="line"><span class="javascript">  <span class="keyword">return</span> customRef(<span class="function">(<span class="params">track, trigger</span>) =&gt;</span> &#123;</span></span><br><span class="line">    fetch(path)</span><br><span class="line"><span class="javascript">      .then(<span class="function">(<span class="params">res</span>) =&gt;</span> res.json())</span></span><br><span class="line"><span class="javascript">      .then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span></span><br><span class="line">        value = data</span><br><span class="line">        trigger()</span><br><span class="line">      &#125;)</span><br><span class="line"><span class="javascript">      .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(err)</span></span><br><span class="line">      &#125;)</span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">get</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 这个数据是需要追中变化的</span></span></span><br><span class="line">        track()</span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">&#x27;get&#x27;</span>, value)</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> value</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">set</span>(<span class="params">newValue</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">&#x27;set&#x27;</span>, newValue)</span></span><br><span class="line">        value = newValue</span><br><span class="line"><span class="javascript">        <span class="comment">// 告诉Vue触发界面更新</span></span></span><br><span class="line">        trigger()</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> state = myRef(<span class="string">&#x27;/data.json&#x27;</span>, [])</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      state,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="25-Vue3-0-ref-获取元素-理解"><a href="#25-Vue3-0-ref-获取元素-理解" class="headerlink" title="25-Vue3.0-ref-获取元素-理解"></a>25-Vue3.0-ref-获取元素-理解</h3><p>在vue3.x中我们也可以通过ref来获取元素</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">    我是div</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; ref, onMounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> box = ref(<span class="literal">null</span>) <span class="comment">// reactive(&#123;value: null&#125;)</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    onMounted(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">&#x27;onMounted&#x27;</span>, box.value)</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      box,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="26-Vue3-0-readonly家族-理解"><a href="#26-Vue3-0-readonly家族-理解" class="headerlink" title="26-Vue3.0-readonly家族-理解"></a>26-Vue3.0-readonly家族-理解</h3><p>用于创建一个只读的数据，并且是递归只读</p>
<h4 id="一、readonly"><a href="#一、readonly" class="headerlink" title="一、readonly"></a>一、readonly</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.name&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.attr.age&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.attr.height&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myFn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; readonly, isReadonly, shallowReadonly &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 用于创建一个只读的数据，并且是递归只读</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> state = readonly(&#123;</span></span><br><span class="line"><span class="javascript">      name: <span class="string">&#x27;lnj&#x27;</span>,</span></span><br><span class="line">      attr: &#123;</span><br><span class="line">        age: 18,</span><br><span class="line">        height: 1.88,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">myFn</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      state.name = <span class="string">&#x27;知播渔&#x27;</span></span></span><br><span class="line">      state.attr.age = 666</span><br><span class="line">      state.attr.height = 1.66</span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state)</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      state,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="二、shallowReadonly"><a href="#二、shallowReadonly" class="headerlink" title="二、shallowReadonly"></a>二、shallowReadonly</h4><p>用于创建一个只读的数据，但不是递归只读的</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.name&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.attr.age&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.attr.height&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myFn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; readonly, isReadonly, shallowReadonly &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 用于创建一个只读的数据，并且是递归只读</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> state = shallowReadonly(&#123;</span></span><br><span class="line"><span class="javascript">      name: <span class="string">&#x27;lnj&#x27;</span>,</span></span><br><span class="line">      attr: &#123;</span><br><span class="line">        age: 18,</span><br><span class="line">        height: 1.88,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">myFn</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      state.name = <span class="string">&#x27;知播渔&#x27;</span></span></span><br><span class="line">      state.attr.age = 666</span><br><span class="line">      state.attr.height = 1.66</span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state)</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      state,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="三、isReadonly"><a href="#三、isReadonly" class="headerlink" title="三、isReadonly"></a>三、isReadonly</h4><p>判断一个数据是否是只读的</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.name&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.attr.age&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;state.attr.height&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;myFn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; readonly, isReadonly, shallowReadonly &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">&#x27;App&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 用于创建一个只读的数据，并且是递归只读</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> state = shallowReadonly(&#123;</span></span><br><span class="line"><span class="javascript">      name: <span class="string">&#x27;lnj&#x27;</span>,</span></span><br><span class="line">      attr: &#123;</span><br><span class="line">        age: 18,</span><br><span class="line">        height: 1.88,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">myFn</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      state.name = <span class="string">&#x27;知播渔&#x27;</span></span></span><br><span class="line">      state.attr.age = 666</span><br><span class="line">      state.attr.height = 1.66</span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(state)</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(isReadonly(state))</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      state,</span><br><span class="line">      myFn,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="四、readonly-和-const-的区别"><a href="#四、readonly-和-const-的区别" class="headerlink" title="四、readonly 和 const 的区别"></a>四、readonly 和 const 的区别</h4><p>const：赋值保护，不能给变量重新赋值<br> readonly：属性保护，不能给属性重新赋值</p>
<h3 id="27-Vue3-0-V3响应式数据本质上-理解-amp-amp-28-Vue3-0-V3响应式数据本质下-理解"><a href="#27-Vue3-0-V3响应式数据本质上-理解-amp-amp-28-Vue3-0-V3响应式数据本质下-理解" class="headerlink" title="27-Vue3.0-V3响应式数据本质上-理解 &amp;&amp; 28-Vue3.0-V3响应式数据本质下-理解"></a>27-Vue3.0-V3响应式数据本质上-理解 &amp;&amp; 28-Vue3.0-V3响应式数据本质下-理解</h3><h4 id="一、Vue3-0响应式数据本质"><a href="#一、Vue3-0响应式数据本质" class="headerlink" title="一、Vue3.0响应式数据本质"></a>一、Vue3.0响应式数据本质</h4><ul>
<li>在Vue2.x中是通过defineProperty来实现响应式数据的<br> 详见：手写Vue全家桶</li>
<li>在Vue3.x中是通过Proxy来实现响应式数据的</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">name</span>: <span class="string">&#x27;lng&#x27;</span>, <span class="attr">age</span>: <span class="number">18</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> state = <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, &#123;</span><br><span class="line">  get (obj, key) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(obj, key)</span><br><span class="line">    <span class="keyword">return</span> obj[key]</span><br><span class="line">  &#125;,</span><br><span class="line">  set (obj, key, value) &#123;</span><br><span class="line">    obj[key] = value</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;更新界面&#x27;</span>, obj, key, value)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(state.name) <span class="comment">// lng</span></span><br><span class="line">state.name = <span class="string">&#x27;直播&#x27;</span></span><br><span class="line"><span class="built_in">console</span>.log(state.name)</span><br></pre></td></tr></table></figure>

<h4 id="二、-Proxy注意点"><a href="#二、-Proxy注意点" class="headerlink" title="二、 Proxy注意点"></a>二、 Proxy注意点</h4><ul>
<li>set方法必须通过返回值告诉Proxy此次操作是否成功</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> state = <span class="keyword">new</span> <span class="built_in">Proxy</span>(arr, &#123;</span><br><span class="line">  get (obj, key) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(obj, key)</span><br><span class="line">    <span class="keyword">return</span> obj[key]</span><br><span class="line">  &#125;,</span><br><span class="line">  set (obj, key, value) &#123;</span><br><span class="line">    obj[key] = value</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;更新界面&#x27;</span>, obj, key, value)</span><br><span class="line">    <span class="comment">// 没有会报错</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(state[<span class="number">1</span>])</span><br><span class="line">state.push(<span class="number">7</span>)</span><br></pre></td></tr></table></figure>

<h3 id="29-Vue3-0-手写-shallowReactive-shallowRef-理解"><a href="#29-Vue3-0-手写-shallowReactive-shallowRef-理解" class="headerlink" title="29-Vue3.0-手写 shallowReactive-shallowRef-理解"></a>29-Vue3.0-手写 shallowReactive-shallowRef-理解</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shallowReactive</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, &#123;</span><br><span class="line">    get (obj, key) &#123;</span><br><span class="line">      <span class="keyword">return</span> obj[key]</span><br><span class="line">    &#125;,</span><br><span class="line">    set (obj, key, value) &#123;</span><br><span class="line">      obj[key] = value</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;更新界面&#x27;</span>, obj, key, value)</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shallowRef</span> (<span class="params">val</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> shallowReactive(&#123;</span><br><span class="line">    value: val</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="30-Vue3-0-手写reactive-ref-理解"><a href="#30-Vue3-0-手写reactive-ref-理解" class="headerlink" title="30-Vue3.0-手写reactive-ref-理解"></a>30-Vue3.0-手写reactive-ref-理解</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reactive</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> obj === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> <span class="built_in">Array</span>) &#123;</span><br><span class="line">      <span class="comment">// 如果是一个数组，那么取出数组中的某一个元素</span></span><br><span class="line">      <span class="comment">// 判断每一个元素是否又是一个对象，如果又是一个对象，如果又是一个对象，那么也需要包装成一个Proxy</span></span><br><span class="line">      obj.forEach(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> item === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">          obj[index] = reactive(item)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 如果是一个对象，那么取出对象属性的取值</span></span><br><span class="line">      <span class="comment">// 判断每一个元素是否又是一个对象，如果又是一个对象，如果又是一个对象，那么也需要包装成一个Proxy</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">        <span class="keyword">let</span> item = obj[key]</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> item === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">          obj[key] = reactive(item)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, &#123;</span><br><span class="line">      get (obj, key) &#123;</span><br><span class="line">        <span class="keyword">return</span> obj[key]</span><br><span class="line">      &#125;,</span><br><span class="line">      set (obj, key, value) &#123;</span><br><span class="line">        obj[key] = value</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;更新界面&#x27;</span>, <span class="built_in">JSON</span>.stringify(obj), key, value)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.warn(<span class="string">&#x27;不是一个对象&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ref</span> (<span class="params">val</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> reactive(&#123;</span><br><span class="line">    value: val</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="31-Vue3-0-手写readonly-shallowReadonly-理解"><a href="#31-Vue3-0-手写readonly-shallowReadonly-理解" class="headerlink" title="31-Vue3.0-手写readonly-shallowReadonly-理解"></a>31-Vue3.0-手写readonly-shallowReadonly-理解</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shallowReadonly</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, &#123;</span><br><span class="line">    get (obj, key) &#123;</span><br><span class="line">      <span class="keyword">return</span> obj[key]</span><br><span class="line">    &#125;,</span><br><span class="line">    set (obj, key, value) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;只读&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readonly</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> obj === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> <span class="built_in">Array</span>) &#123;</span><br><span class="line">      <span class="comment">// 如果是一个数组，那么取出数组中的某一个元素</span></span><br><span class="line">      <span class="comment">// 判断每一个元素是否又是一个对象，如果又是一个对象，如果又是一个对象，那么也需要包装成一个Proxy</span></span><br><span class="line">      obj.forEach(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> item === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">          obj[index] = readonly(item)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 如果是一个对象，那么取出对象属性的取值</span></span><br><span class="line">      <span class="comment">// 判断每一个元素是否又是一个对象，如果又是一个对象，如果又是一个对象，那么也需要包装成一个Proxy</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">        <span class="keyword">let</span> item = obj[key]</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> item === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">          obj[key] = readonly(item)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, &#123;</span><br><span class="line">      get (obj, key) &#123;</span><br><span class="line">        <span class="keyword">return</span> obj[key]</span><br><span class="line">      &#125;,</span><br><span class="line">      set (obj, key, value) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;只读&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.warn(<span class="string">&#x27;不是一个对象&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>本文标题：Vue3.0笔记</li>
        <li>本文作者：馨er</li>
        <li>创建时间：2022-04-14 18:19:36</li>
        <li>
            本文链接：https://sjxbbd.vercel.app/2022/04/14/2c35727a4f30/
        </li>
        <li>
            版权声明：本博客所有文章除特别声明外，均采用 <a class="license" target="_blank" rel="external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> 许可协议。转载请注明出处！
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/Vue/">#Vue</a>&nbsp;
                    </li>
                
            </ul>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev" rel="prev" href="/2022/04/22/7643abe515de/">
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">dos操作指令</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next" rel="next" href="/2022/04/11/5a7c9fba07b6/">
                            <span class="title flex-center">
                                <span class="post-nav-title-item">nodejs笔记</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>
              -
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">馨er</a>
        </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io" rel="external nofollow noopener noreferrer">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep" rel="external nofollow noopener noreferrer">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-02diff%E7%AE%97%E6%B3%95%E2%80%94%E2%80%94%E7%90%86%E8%A7%A3-amp-amp-03%E9%9D%99%E6%80%81%E6%8F%90%E5%8D%87%E5%92%8C%E7%9B%91%E5%90%AC%E7%BC%93%E5%AD%98"><span class="nav-text">1 02diff算法——理解&amp;&amp;03静态提升和监听缓存</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-Vue3-0%E4%B8%AD%E7%9A%84%E5%85%AD%E5%A4%A7%E4%BA%AE%E7%82%B9"><span class="nav-text">1.1 Vue3.0中的六大亮点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-Vue%E6%98%AF%E5%A6%82%E4%BD%95%E5%8F%98%E5%BF%AB%E7%9A%84"><span class="nav-text">1.2 Vue是如何变快的</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-1-diff%E6%96%B9%E6%B3%95%E4%BC%98%E5%8C%96"><span class="nav-text">1.2.1 diff方法优化</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1%E3%80%81Vue2-diff%E7%AE%97%E6%B3%95"><span class="nav-text">1、Vue2 diff算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2%E3%80%81Vue3-diff%E7%AE%97%E6%B3%95"><span class="nav-text">2、Vue3 diff算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3%E3%80%81Vue%E7%BC%96%E8%AF%91demo"><span class="nav-text">3、Vue编译demo</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4%E3%80%81%E9%99%84%E5%BD%95PatchFlags"><span class="nav-text">4、附录PatchFlags</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-2-hoistStatic-%E9%9D%99%E6%80%81%E6%8F%90%E5%8D%87"><span class="nav-text">1.2.2 hoistStatic 静态提升</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1%E3%80%81Vue%E7%BC%96%E8%AF%91demo"><span class="nav-text">1、Vue编译demo</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-3-cacheHandlers%E4%BA%8B%E4%BB%B6%E4%BE%A6%E5%90%AC%E5%99%A8%E7%BC%93%E5%AD%98"><span class="nav-text">1.2.3 cacheHandlers事件侦听器缓存</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1%E3%80%81Vue%E7%BC%96%E8%AF%91demo-1"><span class="nav-text">1、Vue编译demo</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-4-ssr%E6%B8%B2%E6%9F%93"><span class="nav-text">1.2.4 ssr渲染</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-04%E9%A1%B9%E7%9B%AE%E5%88%9B%E5%BB%BA%E2%80%94%E2%80%94%E7%90%86%E8%A7%A3"><span class="nav-text">2 04项目创建——理解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-%E5%88%9B%E5%BB%BAVue3%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="nav-text">2.1 创建Vue3的三种方式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-1-Vue-CLI"><span class="nav-text">2.1.1 Vue-CLI</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-2-Webpack"><span class="nav-text">2.1.2 Webpack</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-3-Vite"><span class="nav-text">2.1.3 Vite</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-%E4%BB%80%E4%B9%88%E6%98%AFVite"><span class="nav-text">2.2  什么是Vite?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-%E5%88%A9%E7%94%A8Vite%E5%88%9B%E5%BB%BAVue3%E9%A1%B9%E7%9B%AE"><span class="nav-text">2.3 利用Vite创建Vue3项目</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-1-%E5%AE%89%E8%A3%85Vite"><span class="nav-text">2.3.1 安装Vite</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-2-%E5%88%9B%E5%BB%BAVue3%E9%A1%B9%E7%9B%AE"><span class="nav-text">2.3.2 创建Vue3项目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-3-%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96%E8%BF%90%E8%A1%8C%E9%A1%B9%E7%9B%AE"><span class="nav-text">2.3.3 安装依赖运行项目</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4-Vue3-0-demo"><span class="nav-text">2.4 Vue3.0 demo</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-05Vue2-x%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98%E2%80%94%E2%80%94%E7%90%86%E8%A7%A3"><span class="nav-text">3 05Vue2.x存在的问题——理解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-todolist-demo"><span class="nav-text">3.1 todolist demo</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-%E9%97%AE%E9%A2%98"><span class="nav-text">3.2 问题</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-06-Vue3-0-%E7%BB%84%E5%90%88API%E4%B8%8A-%E7%90%86%E8%A7%A3"><span class="nav-text">4 06-Vue3.0-组合API上-理解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-%E7%BB%84%E5%90%88API%E5%88%9D%E4%BD%93%E9%AA%8C-demo"><span class="nav-text">4.1 组合API初体验 demo</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="nav-text">4.2 注意点</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-07%E7%BB%84%E5%90%88API%E4%B8%AD%E2%80%94%E2%80%94%E7%90%86%E8%A7%A3"><span class="nav-text">5 07组合API中——理解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1-%E4%B8%9A%E5%8A%A1%E6%8A%BD%E7%A6%BBdemo"><span class="nav-text">5.1 业务抽离demo</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-2-%E7%90%86%E8%A7%A3"><span class="nav-text">5.2 理解</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-08%E7%BB%84%E5%90%88API%E4%B8%8B%E2%80%94%E2%80%94%E7%90%86%E8%A7%A3"><span class="nav-text">6 08组合API下——理解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#6-1-%E5%A4%9A%E6%96%87%E4%BB%B6demo"><span class="nav-text">6.1 多文件demo</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-2-%E7%90%86%E8%A7%A3"><span class="nav-text">6.2 理解</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7-09%E6%9D%A5%E7%82%B9%E5%8A%A8%E5%8A%9B%E2%80%94%E2%80%94%E7%90%86%E8%A7%A3"><span class="nav-text">7 09来点动力——理解</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#8-10-Vue3-0-%E7%BB%84%E5%90%88API%E6%9C%AC%E8%B4%A8-%E7%90%86%E8%A7%A3-amp-amp-11-Vue3-0-setup%E6%89%A7%E8%A1%8C%E6%97%B6%E6%9C%BA%E5%92%8C%E6%B3%A8%E6%84%8F%E7%82%B9-%E7%90%86%E8%A7%A3"><span class="nav-text">8 10-Vue3.0-组合API本质-理解&amp;&amp;11-Vue3.0-setup执行时机和注意点-理解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#8-1-Composition-API-%E5%92%8C-Option-API-%E6%B7%B7%E5%90%88%E4%BD%BF%E7%94%A8"><span class="nav-text">8.1 Composition API 和 Option API 混合使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-1-1-%E6%B7%B7%E5%90%88%E4%BD%BF%E7%94%A8demo"><span class="nav-text">8.1.1 混合使用demo</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-2-Composition-API%E6%9C%AC%E8%B4%A8%EF%BC%88%E7%BB%84%E5%90%88API-%E6%B3%A8%E5%85%A5API%EF%BC%89"><span class="nav-text">8.2  Composition API本质（组合API&#x2F;注入API）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-3-setup%E6%89%A7%E8%A1%8C%E6%97%B6%E6%9C%BA"><span class="nav-text">8.3 setup执行时机</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-4-setup%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="nav-text">8.4 setup注意点</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#9-12reactive-%E7%90%86%E8%A7%A3"><span class="nav-text">9 12reactive-理解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#9-1-%E4%BB%80%E4%B9%88%E6%98%AFreactive"><span class="nav-text">9.1 什么是reactive</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-2-reactiv%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="nav-text">9.2 reactiv注意点</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#9-2-1-%E7%BB%99reactive%E4%BC%A0%E9%80%92%E9%9D%9E%E5%AF%B9%E8%B1%A1%E6%97%A0%E6%B3%95%E5%AE%9E%E7%8E%B0%E5%93%8D%E5%BA%94%E5%BC%8F"><span class="nav-text">9.2.1 给reactive传递非对象无法实现响应式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-2-2-%E9%9C%80%E8%A6%81%E4%BC%A0%E9%80%92%E4%B8%80%E4%B8%AA%E5%AF%B9%E8%B1%A1%E6%89%8D%E5%8F%AF%E4%BB%A5%E5%AE%9E%E7%8E%B0%E5%93%8D%E5%BA%94%E5%BC%8F"><span class="nav-text">9.2.2 需要传递一个对象才可以实现响应式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-2-3-%E6%95%B0%E7%BB%84%E4%B9%9F%E5%8F%AF%E4%BB%A5%E7%9B%91%E5%90%AC"><span class="nav-text">9.2.3 数组也可以监听</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#4-%E5%85%B6%E4%BB%96%E5%AF%B9%E8%B1%A1%E4%B8%8D%E8%83%BD%E5%AE%9E%E7%8E%B0%E5%93%8D%E5%BA%94%E5%BC%8F%EF%BC%8C%E9%9C%80%E8%A6%81%E9%87%8D%E6%96%B0%E8%B5%8B%E5%80%BC"><span class="nav-text">4. 其他对象不能实现响应式，需要重新赋值</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-Vue3-0-ref-%E7%90%86%E8%A7%A3"><span class="nav-text">13-Vue3.0-ref-理解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AFref"><span class="nav-text">一、什么是ref</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E3%80%81ref%E6%9C%AC%E8%B4%A8"><span class="nav-text">二、ref本质</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%89%E3%80%81ref%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="nav-text">三、ref注意点</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#14-Vue3-0-ref%E5%92%8Creactive%E5%8C%BA%E5%88%AB-%E7%90%86%E8%A7%A3"><span class="nav-text">14-Vue3.0-ref和reactive区别-理解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E3%80%81Vue%E5%9C%A8%E5%A4%84%E7%90%86%E7%9A%84%E6%97%B6%E5%80%99%E4%BC%9A%E5%85%88%E5%88%A4%E6%96%AD%E6%95%B0%E6%8D%AE%E6%98%AF%E4%BB%80%E4%B9%88%E7%B1%BB%E5%9E%8B%E7%9A%84"><span class="nav-text">一、Vue在处理的时候会先判断数据是什么类型的</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E3%80%81Vue%E6%98%AF%E5%A6%82%E4%BD%95%E5%88%A4%E6%96%AD%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%91%A2"><span class="nav-text">二、Vue是如何判断数据类型的呢</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E6%89%93%E5%8D%B0ref%E6%95%B0%E6%8D%AE%E7%9A%84%E7%BB%93%E6%9E%9C"><span class="nav-text">1. 打印ref数据的结果</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E8%A7%A3%E9%87%8A"><span class="nav-text">2. 解释</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%89%E3%80%81isRef%E5%92%8CisReactive"><span class="nav-text">三、isRef和isReactive</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-Vue3-0-%E9%80%92%E5%BD%92%E7%9B%91%E5%90%AC%E7%90%86%E8%A7%A3"><span class="nav-text">15-Vue3.0-递归监听理解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E9%80%92%E5%BD%92%E7%9B%91%E5%90%AC"><span class="nav-text">一、递归监听</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-reactive%E9%80%92%E5%BD%92%E7%9B%91%E5%90%AC"><span class="nav-text">1. reactive递归监听</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-ref%E9%80%92%E5%BD%92%E7%9B%91%E5%90%AC"><span class="nav-text">2. ref递归监听</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E9%80%92%E5%BD%92%E7%9B%91%E5%90%AC%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-text">二、递归监听存在的问题</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E9%80%92%E5%BD%92%E7%9B%91%E5%90%AC%E9%AA%8C%E8%AF%81"><span class="nav-text">1. 递归监听验证</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#16-Vue3-0-%E9%9D%9E%E9%80%92%E5%BD%92%E7%9B%91%E5%90%AC-%E6%8E%8C%E6%8F%A1"><span class="nav-text">16-Vue3.0-非递归监听-掌握</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E9%9D%9E%E9%80%92%E5%BD%92%E7%9B%91%E5%90%AC"><span class="nav-text">一、非递归监听</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-shallowReactive"><span class="nav-text">1. shallowReactive</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-shallowRef"><span class="nav-text">2. shallowRef</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-triggerRef"><span class="nav-text">3. triggerRef</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#17-Vue3-0-shallowRef%E6%9C%AC%E8%B4%A8"><span class="nav-text">17-Vue3.0-shallowRef本质</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#18-Vue3-0-toRaw-amp-amp-19-Vue3-0-toRaw"><span class="nav-text">18-Vue3.0-toRaw &amp;&amp; 19-Vue3.0-toRaw</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E3%80%81toRaw"><span class="nav-text">一、toRaw</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E3%80%81toRaw%E4%BD%9C%E7%94%A8"><span class="nav-text">二、toRaw作用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%89%E3%80%81ref%E7%9A%84toRaw"><span class="nav-text">三、ref的toRaw</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#20-Vue3-0-markRaw"><span class="nav-text">20-Vue3.0-markRaw</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#21-Vue3-0-toRef-%E7%90%86%E8%A7%A3"><span class="nav-text">21-Vue3.0-toRef-理解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E3%80%81toRef%E7%9A%84%E7%90%86%E8%A7%A3"><span class="nav-text">一、toRef的理解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E3%80%81ref%E5%92%8CtoRef%E5%8C%BA%E5%88%AB"><span class="nav-text">二、ref和toRef区别</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%89%E3%80%81toRef%E5%BC%95%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-text">三、toRef引用场景</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#22-Vue3-0-toRefs-%E7%90%86%E8%A7%A3"><span class="nav-text">22-Vue3.0-toRefs-理解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#23-Vue3-0-customRef-%E4%B8%8A-%E7%90%86%E8%A7%A3-amp-amp-24-Vue3-0-customRef-%E4%B8%8B-%E7%90%86%E8%A7%A3"><span class="nav-text">23-Vue3.0-customRef 上-理解 &amp;&amp; 24-Vue3.0-customRef 下-理解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E3%80%81customRef"><span class="nav-text">一、customRef</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BD%BF%E7%94%A8customRef"><span class="nav-text">二、为什么要使用customRef</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#25-Vue3-0-ref-%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0-%E7%90%86%E8%A7%A3"><span class="nav-text">25-Vue3.0-ref-获取元素-理解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#26-Vue3-0-readonly%E5%AE%B6%E6%97%8F-%E7%90%86%E8%A7%A3"><span class="nav-text">26-Vue3.0-readonly家族-理解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E3%80%81readonly"><span class="nav-text">一、readonly</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E3%80%81shallowReadonly"><span class="nav-text">二、shallowReadonly</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%89%E3%80%81isReadonly"><span class="nav-text">三、isReadonly</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9B%9B%E3%80%81readonly-%E5%92%8C-const-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-text">四、readonly 和 const 的区别</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#27-Vue3-0-V3%E5%93%8D%E5%BA%94%E5%BC%8F%E6%95%B0%E6%8D%AE%E6%9C%AC%E8%B4%A8%E4%B8%8A-%E7%90%86%E8%A7%A3-amp-amp-28-Vue3-0-V3%E5%93%8D%E5%BA%94%E5%BC%8F%E6%95%B0%E6%8D%AE%E6%9C%AC%E8%B4%A8%E4%B8%8B-%E7%90%86%E8%A7%A3"><span class="nav-text">27-Vue3.0-V3响应式数据本质上-理解 &amp;&amp; 28-Vue3.0-V3响应式数据本质下-理解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E3%80%81Vue3-0%E5%93%8D%E5%BA%94%E5%BC%8F%E6%95%B0%E6%8D%AE%E6%9C%AC%E8%B4%A8"><span class="nav-text">一、Vue3.0响应式数据本质</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E3%80%81-Proxy%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="nav-text">二、 Proxy注意点</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#29-Vue3-0-%E6%89%8B%E5%86%99-shallowReactive-shallowRef-%E7%90%86%E8%A7%A3"><span class="nav-text">29-Vue3.0-手写 shallowReactive-shallowRef-理解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#30-Vue3-0-%E6%89%8B%E5%86%99reactive-ref-%E7%90%86%E8%A7%A3"><span class="nav-text">30-Vue3.0-手写reactive-ref-理解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#31-Vue3-0-%E6%89%8B%E5%86%99readonly-shallowReadonly-%E7%90%86%E8%A7%A3"><span class="nav-text">31-Vue3.0-手写readonly-shallowReadonly-理解</span></a></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src>
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input">
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>



    
<script src="/js/local-search.js"></script>




    
<script src="/js/code-copy.js"></script>





<div class="post-scripts pjax">
    
        
<script src="/js/left-side-toggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/toc.js"></script>

    
</div>


    
<script src="/js/libs/pjax.min.js"></script>

<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
